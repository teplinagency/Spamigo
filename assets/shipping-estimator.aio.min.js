/*
Generated time: October 28, 2024 01:50
This file was created by the app developer. Feel free to contact the original developer with any questions. It was minified (compressed) by AVADA. AVADA do NOT own this script.
*/
if(!customElements.get("shipping-estimator")){class a extends HTMLElement{constructor(){super()}connectedCallback(){this.setupCountries(),this.submitButton=this.querySelector('[type="button"]'),this.submitButton.addEventListener("click",this.estimateShipping.bind(this)),this.results=this.querySelector(".shipping-estimator--results")}async estimateShipping(){var t=this.querySelector(".shipping-estimator-zip").value,e=this.querySelector(".shipping-estimator-country").value,i=this.querySelector(".shipping-estimator-province").value,s=(this.submitButton.classList.add("loading"),await fetch(window.theme.routes.cart_url+`/prepare_shipping_rates.json?shipping_address[zip]=${t}&shipping_address[country]=${e}&shipping_address[province]=`+i,{method:"POST"}));s.ok?(t=await this.getShippingRates(t,e,i),this.formatShippingRates(t)):(e=await s.json(),this.formatError(e)),this.submitButton.classList.remove("loading")}async getShippingRates(t,e,i){var s=await(await fetch(window.theme.routes.cart_url+`/async_shipping_rates.json?shipping_address[zip]=${t}&shipping_address[country]=${e}&shipping_address[province]=`+i)).text();return"null"===s?this.getShippingRates(t,e,i):JSON.parse(s).shipping_rates}formatShippingRates(t){let e="",i="",s=window.theme.settings.money_with_currency_format||"${{amount}}";t.forEach(t=>{e+=`<li>${t.presentment_name}: ${formatMoney(100*parseFloat(t.price),s)}</li>`});t=`
        <p>${i=0===t.length?window.theme.strings.shippingEstimatorNoResults:1===t.length?window.theme.strings.shippingEstimatorOneResult:window.theme.strings.shippingEstimatorMultipleResults}</p>
        ${""===e?"":`<ul>${e}</ul>`}
      `;this.results.innerHTML="",this.results.insertAdjacentHTML("beforeend",t)}formatError(e){let i="";Object.keys(e).forEach(t=>{i+=`<li>${t} ${e[t]}</li>`});var t=`
        <p>${window.theme.strings.shippingEstimatorError}</p>
        <ul>${i}</ul>
      `;this.results.innerHTML="",this.results.insertAdjacentHTML("beforeend",t)}setupCountries(){var t;Shopify&&Shopify.CountryProvinceSelector&&(t=this.dataset.formId,new Shopify.CountryProvinceSelector("shipping-estimator-country-"+t,"shipping-estimator-province-"+t,{hideElement:"shipping-estimator-province-wrapper-"+t}))}}customElements.define("shipping-estimator",a)}