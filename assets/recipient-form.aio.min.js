/*
Generated time: October 28, 2024 01:50
This file was created by the app developer. Feel free to contact the original developer with any questions. It was minified (compressed) by AVADA. AVADA do NOT own this script.
*/
customElements.get("recipient-form")||customElements.define("recipient-form",class extends HTMLElement{constructor(){super(),this.checkboxInput=this.querySelector("#Recipient-Checkbox-"+this.dataset.sectionId),this.checkboxInput.disabled=!1,this.hiddenControlField=this.querySelector("#Recipient-Control-"+this.dataset.sectionId),this.hiddenControlField.disabled=!0,this.emailInput=this.querySelector("#Recipient-email-"+this.dataset.sectionId),this.nameInput=this.querySelector("#Recipient-name-"+this.dataset.sectionId),this.messageInput=this.querySelector("#Recipient-message-"+this.dataset.sectionId),this.errorMessageWrapper=this.querySelector(".product-form__recipient-error-message-wrapper"),this.errorMessageList=this.errorMessageWrapper?.querySelector("ul"),this.errorMessage=this.errorMessageWrapper?.querySelector(".error-message"),this.defaultErrorHeader=this.errorMessage?.innerText,this.currentProductVariantId=this.dataset.productVariantId,this.addEventListener("change",this.onChange.bind(this))}connectedCallback(){document.addEventListener("cart:item-added",this.onCartAdded.bind(this)),document.addEventListener("product:variant-change",this.onVariantChange.bind(this)),document.addEventListener("product:variant-error",this.onVariantError.bind(this))}onCartAdded(e){e.detail.product.id.toString()===this.currentProductVariantId&&this.resetRecipientForm()}onVariantChange(e){e.detail.sectionId===this.dataset.sectionId&&(this.currentProductVariantId=e.detail.variant.id.toString())}onVariantError(e){"product-form"===e.detail.source&&e.detail.productVariantId.toString()===this.currentProductVariantId&&this.displayErrorMessage(e.detail.message,e.detail.errors)}onChange(){this.checkboxInput.checked||(this.clearInputFields(),this.clearErrorMessage())}clearInputFields(){this.emailInput.value="",this.nameInput.value="",this.messageInput.value=""}displayErrorMessage(e,t){if(this.clearErrorMessage(),this.errorMessageWrapper.hidden=!1,"object"==typeof t)return this.errorMessage.innerText=this.defaultErrorHeader,Object.entries(t).forEach(([e,t])=>{var r=`RecipientForm-${e}-error-`+this.dataset.sectionId,i=`#Recipient-${e}-`+this.dataset.sectionId,t=(this.querySelector(i)?.getAttribute("placeholder")||e)+" "+t,s=this.querySelector("#"+r),a=s?.querySelector(".error-message");a&&(this.errorMessageList&&this.errorMessageList.appendChild(this.createErrorListItem(i,t)),a.innerText=t+".",s.classList.remove("hidden"),i=this[e+"Input"])&&(i.setAttribute("aria-invalid",!0),i.setAttribute("aria-describedby",r))});this.errorMessage.innerText=t}createErrorListItem(e,t){var r=document.createElement("li"),i=document.createElement("a");return i.setAttribute("href",e),i.innerText=t,r.appendChild(i),r.className="error-message",r}clearErrorMessage(){this.errorMessageWrapper.hidden=!0,this.errorMessageList&&(this.errorMessageList.innerHTML=""),this.querySelectorAll(".recipient-fields .form__message").forEach(e=>{e.classList.add("hidden");e=e.querySelector(".error-message");e&&(e.innerText="")}),[this.emailInput,this.messageInput,this.nameInput].forEach(e=>{e.setAttribute("aria-invalid",!1),e.removeAttribute("aria-describedby")})}resetRecipientForm(){this.checkboxInput.checked&&(this.checkboxInput.checked=!1,this.clearInputFields(),this.clearErrorMessage())}});